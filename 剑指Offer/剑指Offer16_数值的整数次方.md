## &#127800; 剑指 Offer 16. 数值的整数次方 &#127800;

### &#127826; 题目

实现 `pow(x, n)` ，即计算 `x` 的 `n` 次幂函数（即，${x^n}$）。不得使用库函数，同时不需要考虑大数问题。

##### 示例 1：

输入：x = 2.00000, n = 10<br>
输出：1024.00000
##### 示例 2：

输入：x = 2.10000, n = 3<br>
输出：9.26100
##### 示例 3：

输入：x = 2.00000, n = -2<br>
输出：0.25000<br>
解释：2-2 = 1/22 = 1/4 = 0.25

#### Constraints:

- -100.0 < x < 100.0
- ${-2^{31} <= n <= 2^{31}-1}$
- ${-10^4 <= x^n <= 10^4}$

### &#127826; 题解


<details>
<summary>&#127808; 迭代 &#127808;</summary>

### 思路

1. 首先处理一下n为负数的情况，把x取一下倒数并且把n变为正数即可
2. 接下来以`x = 2, n = 18, res = 1`为例解释一下迭代的过程
    - 18 的二进制数为 `0001 0010`
    - ${x ^ {18} = x ^ {16} * x ^ 2 = x ^{0b0001 0000} * x^{0b0010}}$
    - 令循环体为 `x *= x，n >>= 1`
    - 循环1次可以得到${x = x ^ 2 = 4, n = 9, result = 1}$
    - 循环2次的时候n为奇数9，
      - **把第一次的这个${x ^ 2 }$乘到结果1中**,得到${x = x ^ 4 = 16, n = 4, result = 4}$
    - 循环3次可以得到 ${x = x ^ {16} = 256, n = 2, result = 4}$
    - 循环4次可以得到 ${x = x ^ {32} = 65536, n = 1, result = 4}$
    - 循环5次的时候n为奇数9，
      - **把第一次的这个${x ^ 32 }$乘到结果4中**，可以得到 ${x = x ^ {64} = 4294967296, n = 0, result = 262144}$
    - 第六次时n=0，跳出
    - 也就是n的二进制数中有几个1，需要的resut就会乘几次，且乘数在循环中一次一次倍增
> 因为由java整型范围是 [−2147483648,2147483647] 所以在执行 n = -n 时会出现Java溢出的问题，用一个long类型的变量b来代替n

### 步骤

  
```java
    public double myPow2(double x, int n) {
        // 特殊情况 任何数字的 0 次方都等于 1
        if (x == 0) return 0;
        // 由于java整型范围是 [−2147483648,2147483647] 所以在执行 n = -n 时会越界出错
        // 解决方法是增大数值类型范围 先将 n 存入 long 变量 b ，后面用 b 操作即可。
        long b = n;
        //
        double res = 1.0;
        // 若指数为负数，则变为倒数相乘
        if (b < 0) {
            x = 1 / x;
            b = -b;
        }
        // 循环遍历，若指数大于0 则不断二分运算
        while (b > 0) {
            // 若指数为奇数，则把结果直接与原数乘一次
            if ((b & 1) == 1) res *= x;
            // 二分法运算所在，将运算后的值相乘，而不是将结果与原数相乘，这样就会减少很多次运算
            x *= x;
            // 位运算,将十进制转为二进制，将二进制数右移一位（即1101和1100右移后为同一个数字）
            b >>= 1;
        }
        return res;
    }
```
  
</details>
  
  
[参考](画手大鹏 "链接：https://leetcode-cn.com/problems/maximum-subarray/solution/hua-jie-suan-fa-53-zui-da-zi-xu-he-by-guanpengchn/")